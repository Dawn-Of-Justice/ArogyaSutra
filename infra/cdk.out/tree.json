{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.240.0"},"children":{"ArogyaSutraStack":{"id":"ArogyaSutraStack","path":"ArogyaSutraStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.240.0"},"children":{"MasterKey":{"id":"MasterKey","path":"ArogyaSutraStack/MasterKey","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/MasterKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"description":"ArogyaSutra root encryption key for envelope encryption","enableKeyRotation":true,"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::573263824787:root"]]}},"Resource":"*"}],"Version":"2012-10-17"},"pendingWindowInDays":30}}},"Alias":{"id":"Alias","path":"ArogyaSutraStack/MasterKey/Alias","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Alias","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/MasterKey/Alias/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnAlias","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Alias","aws:cdk:cloudformation:props":{"aliasName":"alias/arogyasutra-master-key","targetKeyId":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}}}}}}}},"HealthRecordsBucket":{"id":"HealthRecordsBucket","path":"ArogyaSutraStack/HealthRecordsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/HealthRecordsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"aws:kms","kmsMasterKeyId":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}}}]},"corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST"],"allowedOrigins":["http://localhost:3000","https://*.amplifyapp.com"]}]},"lifecycleConfiguration":{"rules":[{"id":"move-to-ia","status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":90},{"storageClass":"GLACIER","transitionInDays":365}]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"ArogyaSutraStack/HealthRecordsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/HealthRecordsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"HealthRecordsBucket28A5ADA9"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}}}},"AuditLogsTable":{"id":"AuditLogsTable","path":"ArogyaSutraStack/AuditLogsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/AuditLogsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"patientId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"},{"attributeName":"action","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"by-action","keySchema":[{"attributeName":"action","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"patientId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ArogyaSutraStack/AuditLogsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.240.0"}}}},"AccessGrantsTable":{"id":"AccessGrantsTable","path":"ArogyaSutraStack/AccessGrantsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/AccessGrantsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"patientId","attributeType":"S"},{"attributeName":"doctorId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"patientId","keyType":"HASH"},{"attributeName":"doctorId","keyType":"RANGE"}],"sseSpecification":{"sseEnabled":true},"timeToLiveSpecification":{"attributeName":"expiresAt","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ArogyaSutraStack/AccessGrantsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.240.0"}}}},"SessionsTable":{"id":"SessionsTable","path":"ArogyaSutraStack/SessionsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/SessionsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"sessionId","attributeType":"S"},{"attributeName":"patientId","attributeType":"S"},{"attributeName":"startedAt","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"by-patient","keySchema":[{"attributeName":"patientId","keyType":"HASH"},{"attributeName":"startedAt","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"sessionId","keyType":"HASH"}],"sseSpecification":{"sseEnabled":true},"timeToLiveSpecification":{"attributeName":"expiresAt","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ArogyaSutraStack/SessionsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.240.0"}}}},"NotificationsTopic":{"id":"NotificationsTopic","path":"ArogyaSutraStack/NotificationsTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/NotificationsTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"ArogyaSutra Patient Notifications","topicName":"arogyasutra-notifications"}}}}},"DefineAuthChallenge":{"id":"DefineAuthChallenge","path":"ArogyaSutraStack/DefineAuthChallenge","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.240.0"},"children":{"ServiceRole":{"id":"ServiceRole","path":"ArogyaSutraStack/DefineAuthChallenge/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/DefineAuthChallenge/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"ArogyaSutraStack/DefineAuthChallenge/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.240.0"},"children":{"Stage":{"id":"Stage","path":"ArogyaSutraStack/DefineAuthChallenge/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.240.0"}},"AssetBucket":{"id":"AssetBucket","path":"ArogyaSutraStack/DefineAuthChallenge/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.240.0"}}}},"Resource":{"id":"Resource","path":"ArogyaSutraStack/DefineAuthChallenge/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-573263824787-ap-south-1","s3Key":"6bb840c4291f090df43a7e18f9897a0a7252d6963d5f4973b14b644394235e6e.zip"},"functionName":"arogyasutra-define-auth","handler":"index.handler","memorySize":128,"role":{"Fn::GetAtt":["DefineAuthChallengeServiceRole1D83696B","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"CreateAuthChallenge":{"id":"CreateAuthChallenge","path":"ArogyaSutraStack/CreateAuthChallenge","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.240.0"},"children":{"ServiceRole":{"id":"ServiceRole","path":"ArogyaSutraStack/CreateAuthChallenge/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/CreateAuthChallenge/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ArogyaSutraStack/CreateAuthChallenge/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/CreateAuthChallenge/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"NotificationsTopicE4AF40A8"}},{"Action":"sns:Publish","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"CreateAuthChallengeServiceRoleDefaultPolicy637265A4","roles":[{"Ref":"CreateAuthChallengeServiceRoleCE50EC04"}]}}}}}}},"Code":{"id":"Code","path":"ArogyaSutraStack/CreateAuthChallenge/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.240.0"},"children":{"Stage":{"id":"Stage","path":"ArogyaSutraStack/CreateAuthChallenge/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.240.0"}},"AssetBucket":{"id":"AssetBucket","path":"ArogyaSutraStack/CreateAuthChallenge/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.240.0"}}}},"Resource":{"id":"Resource","path":"ArogyaSutraStack/CreateAuthChallenge/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-573263824787-ap-south-1","s3Key":"f020bbf7f576240cbb803fd11db9c9a024d0ad2d14bbb0d826630f7ac853f30b.zip"},"environment":{"variables":{"AWS_SNS_REGION":"ap-south-1"}},"functionName":"arogyasutra-create-auth","handler":"index.handler","memorySize":128,"role":{"Fn::GetAtt":["CreateAuthChallengeServiceRoleCE50EC04","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"VerifyAuthChallenge":{"id":"VerifyAuthChallenge","path":"ArogyaSutraStack/VerifyAuthChallenge","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.240.0"},"children":{"ServiceRole":{"id":"ServiceRole","path":"ArogyaSutraStack/VerifyAuthChallenge/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/VerifyAuthChallenge/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"ArogyaSutraStack/VerifyAuthChallenge/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.240.0"},"children":{"Stage":{"id":"Stage","path":"ArogyaSutraStack/VerifyAuthChallenge/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.240.0"}},"AssetBucket":{"id":"AssetBucket","path":"ArogyaSutraStack/VerifyAuthChallenge/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.240.0"}}}},"Resource":{"id":"Resource","path":"ArogyaSutraStack/VerifyAuthChallenge/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-573263824787-ap-south-1","s3Key":"77a47a1de80f9423ff1b60b781f278011f584b0e17e30a6e6337b3bebb42415e.zip"},"functionName":"arogyasutra-verify-auth","handler":"index.handler","memorySize":128,"role":{"Fn::GetAtt":["VerifyAuthChallengeServiceRole0AEAA465","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"PatientUserPool":{"id":"PatientUserPool","path":"ArogyaSutraStack/PatientUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.240.0"},"children":{"DefineAuthChallengeCognito":{"id":"DefineAuthChallengeCognito","path":"ArogyaSutraStack/PatientUserPool/DefineAuthChallengeCognito","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DefineAuthChallengeE7E3BC7B","Arn"]},"principal":"cognito-idp.amazonaws.com","sourceArn":{"Fn::GetAtt":["PatientUserPool12075B47","Arn"]}}}},"CreateAuthChallengeCognito":{"id":"CreateAuthChallengeCognito","path":"ArogyaSutraStack/PatientUserPool/CreateAuthChallengeCognito","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["CreateAuthChallengeB2F8D873","Arn"]},"principal":"cognito-idp.amazonaws.com","sourceArn":{"Fn::GetAtt":["PatientUserPool12075B47","Arn"]}}}},"VerifyAuthChallengeResponseCognito":{"id":"VerifyAuthChallengeResponseCognito","path":"ArogyaSutraStack/PatientUserPool/VerifyAuthChallengeResponseCognito","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["VerifyAuthChallenge610ED36B","Arn"]},"principal":"cognito-idp.amazonaws.com","sourceArn":{"Fn::GetAtt":["PatientUserPool12075B47","Arn"]}}}},"Resource":{"id":"Resource","path":"ArogyaSutraStack/PatientUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":true},"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","lambdaConfig":{"defineAuthChallenge":{"Fn::GetAtt":["DefineAuthChallengeE7E3BC7B","Arn"]},"createAuthChallenge":{"Fn::GetAtt":["CreateAuthChallengeB2F8D873","Arn"]},"verifyAuthChallengeResponse":{"Fn::GetAtt":["VerifyAuthChallenge610ED36B","Arn"]}},"policies":{"passwordPolicy":{"temporaryPasswordValidityDays":1,"minimumLength":12,"requireUppercase":true,"requireNumbers":true,"requireSymbols":true}},"schema":[{"name":"phone_number","mutable":true,"required":true},{"name":"birthdate","mutable":false,"required":true},{"name":"name","mutable":true,"required":true},{"name":"card_id","attributeDataType":"String","stringAttributeConstraints":{"minLength":"12","maxLength":"12"},"mutable":false},{"name":"dob","attributeDataType":"String","mutable":false}],"smsVerificationMessage":"The verification code to your new account is {####}","userPoolName":"arogyasutra-patients","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"PatientAppClient":{"id":"PatientAppClient","path":"ArogyaSutraStack/PatientUserPool/PatientAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/PatientUserPool/PatientAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"accessTokenValidity":60,"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"clientName":"arogyasutra-patient-web","explicitAuthFlows":["ALLOW_CUSTOM_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"idTokenValidity":60,"preventUserExistenceErrors":"ENABLED","refreshTokenValidity":43200,"supportedIdentityProviders":["COGNITO"],"tokenValidityUnits":{"idToken":"minutes","accessToken":"minutes","refreshToken":"minutes"},"userPoolId":{"Ref":"PatientUserPool12075B47"}}}}}}}},"DoctorUserPool":{"id":"DoctorUserPool","path":"ArogyaSutraStack/DoctorUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/DoctorUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1},{"name":"verified_email","priority":2}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":true},"aliasAttributes":["email"],"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","policies":{"passwordPolicy":{"minimumLength":12,"requireUppercase":true,"requireNumbers":true,"requireSymbols":true}},"schema":[{"name":"email","mutable":true,"required":true},{"name":"name","mutable":true,"required":true},{"name":"phone_number","mutable":true,"required":true},{"name":"mci_number","attributeDataType":"String","stringAttributeConstraints":{"minLength":"5","maxLength":"20"},"mutable":false},{"name":"institution","attributeDataType":"String","mutable":true},{"name":"designation","attributeDataType":"String","mutable":true}],"smsVerificationMessage":"The verification code to your new account is {####}","userPoolName":"arogyasutra-doctors","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"DoctorAppClient":{"id":"DoctorAppClient","path":"ArogyaSutraStack/DoctorUserPool/DoctorAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/DoctorUserPool/DoctorAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"accessTokenValidity":60,"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"clientName":"arogyasutra-doctor-web","explicitAuthFlows":["ALLOW_ADMIN_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"idTokenValidity":60,"preventUserExistenceErrors":"ENABLED","refreshTokenValidity":10080,"supportedIdentityProviders":["COGNITO"],"tokenValidityUnits":{"idToken":"minutes","accessToken":"minutes","refreshToken":"minutes"},"userPoolId":{"Ref":"DoctorUserPoolCA56D27E"}}}}}}}},"AppBackendRole":{"id":"AppBackendRole","path":"ArogyaSutraStack/AppBackendRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/AppBackendRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}},{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"amplify.amazonaws.com"}}],"Version":"2012-10-17"},"roleName":"arogyasutra-app-backend"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ArogyaSutraStack/AppBackendRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/AppBackendRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},"/*"]]}]},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:ReEncrypt*","kms:GenerateDataKey*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}},{"Action":["kms:Decrypt","kms:Encrypt","kms:ReEncrypt*","kms:GenerateDataKey*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}},{"Action":["dynamodb:BatchGetItem","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AuditLogsTable7D096F6F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AuditLogsTable7D096F6F","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AuditLogsTable7D096F6F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AuditLogsTable7D096F6F","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":{"Fn::GetAtt":["AccessGrantsTableFFA0880B","Arn"]}},{"Action":["dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":{"Fn::GetAtt":["AccessGrantsTableFFA0880B","Arn"]}},{"Action":["dynamodb:BatchGetItem","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["SessionsTable7C302024","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["SessionsTable7C302024","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["SessionsTable7C302024","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["SessionsTable7C302024","Arn"]},"/index/*"]]}]},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"NotificationsTopicE4AF40A8"}},{"Action":["textract:AnalyzeDocument","textract:DetectDocumentText"],"Effect":"Allow","Resource":"*","Sid":"TextractAccess"},{"Action":["comprehendmedical:DetectEntitiesV2","comprehendmedical:InferICD10CM","comprehendmedical:InferRxNorm"],"Effect":"Allow","Resource":"*","Sid":"ComprehendMedicalAccess"},{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":"*","Sid":"BedrockAccess"},{"Action":["healthlake:CreateResource","healthlake:ReadResource","healthlake:UpdateResource","healthlake:SearchWithGet","healthlake:SearchWithPost"],"Effect":"Allow","Resource":"*","Sid":"HealthLakeAccess"}],"Version":"2012-10-17"},"policyName":"AppBackendRoleDefaultPolicy6EA40799","roles":[{"Ref":"AppBackendRoleC81DE21A"}]}}}}}}},"IdentityPool":{"id":"IdentityPool","path":"ArogyaSutraStack/IdentityPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnIdentityPool","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::IdentityPool","aws:cdk:cloudformation:props":{"allowUnauthenticatedIdentities":false,"cognitoIdentityProviders":[{"clientId":{"Ref":"PatientUserPoolPatientAppClientD7CFCFCC"},"providerName":{"Fn::GetAtt":["PatientUserPool12075B47","ProviderName"]}},{"clientId":{"Ref":"DoctorUserPoolDoctorAppClient1F1CAC42"},"providerName":{"Fn::GetAtt":["DoctorUserPoolCA56D27E","ProviderName"]}}],"identityPoolName":"arogyasutra_identity_pool"}}},"CognitoAuthRole":{"id":"CognitoAuthRole","path":"ArogyaSutraStack/CognitoAuthRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/CognitoAuthRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRoleWithWebIdentity","Condition":{"StringEquals":{"cognito-identity.amazonaws.com:aud":{"Ref":"IdentityPool"}},"ForAnyValue:StringLike":{"cognito-identity.amazonaws.com:amr":"authenticated"}},"Effect":"Allow","Principal":{"Federated":"cognito-identity.amazonaws.com"}}],"Version":"2012-10-17"},"roleName":"arogyasutra-cognito-authenticated"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ArogyaSutraStack/CognitoAuthRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.240.0"},"children":{"Resource":{"id":"Resource","path":"ArogyaSutraStack/CognitoAuthRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["HealthRecordsBucket28A5ADA9","Arn"]},"/patients/${cognito-identity.amazonaws.com:sub}/*"]]}]},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:ReEncrypt*","kms:GenerateDataKey*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}},{"Action":["kms:Decrypt","kms:Encrypt","kms:ReEncrypt*","kms:GenerateDataKey*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["MasterKey0175C9E2","Arn"]}},{"Action":["textract:AnalyzeDocument","textract:DetectDocumentText"],"Effect":"Allow","Resource":"*","Sid":"TextractForPatient"},{"Action":["comprehendmedical:DetectEntitiesV2","comprehendmedical:InferICD10CM"],"Effect":"Allow","Resource":"*","Sid":"ComprehendMedicalForPatient"},{"Action":"bedrock:InvokeModel","Effect":"Allow","Resource":"*","Sid":"BedrockForPatient"}],"Version":"2012-10-17"},"policyName":"CognitoAuthRoleDefaultPolicy942426C8","roles":[{"Ref":"CognitoAuthRole7B7E27C0"}]}}}}}}},"IdentityPoolRoles":{"id":"IdentityPoolRoles","path":"ArogyaSutraStack/IdentityPoolRoles","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnIdentityPoolRoleAttachment","version":"2.240.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::IdentityPoolRoleAttachment","aws:cdk:cloudformation:props":{"identityPoolId":{"Ref":"IdentityPool"},"roles":{"authenticated":{"Fn::GetAtt":["CognitoAuthRole7B7E27C0","Arn"]}}}}},"KmsKeyId":{"id":"KmsKeyId","path":"ArogyaSutraStack/KmsKeyId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"S3BucketName":{"id":"S3BucketName","path":"ArogyaSutraStack/S3BucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"PatientPoolId":{"id":"PatientPoolId","path":"ArogyaSutraStack/PatientPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"PatientClientId":{"id":"PatientClientId","path":"ArogyaSutraStack/PatientClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"DoctorPoolId":{"id":"DoctorPoolId","path":"ArogyaSutraStack/DoctorPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"DoctorClientId":{"id":"DoctorClientId","path":"ArogyaSutraStack/DoctorClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"SnsTopicArn":{"id":"SnsTopicArn","path":"ArogyaSutraStack/SnsTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"AuditTableName":{"id":"AuditTableName","path":"ArogyaSutraStack/AuditTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"AccessTableName":{"id":"AccessTableName","path":"ArogyaSutraStack/AccessTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"SessionTableName":{"id":"SessionTableName","path":"ArogyaSutraStack/SessionTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"IdentityPoolId":{"id":"IdentityPoolId","path":"ArogyaSutraStack/IdentityPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"AppBackendRoleArn":{"id":"AppBackendRoleArn","path":"ArogyaSutraStack/AppBackendRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.240.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ArogyaSutraStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.5.1"},"children":{"Default":{"id":"Default","path":"ArogyaSutraStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.240.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ArogyaSutraStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.240.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ArogyaSutraStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.240.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.5.1"}}}}}